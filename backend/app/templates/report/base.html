<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Raport Fotowoltaiczny — Soolevo</title>
    <style>{{ css_content | safe }}</style>
</head>

<body>

    {# ── Element niewidoczny — przekazuje datę do CSS string() dla stopki @page ── #}
    <span class="pdf-generation-date" aria-hidden="true">{{ generation_date }}</span>

    {# ════════════════════════════════════════════════════════════════════════
       STRONA 1: DASHBOARD — Okładka + Dane wejściowe + Werdykt
       Okładka NIE ma page-break-after — S0 i S1 dołączają na tej samej stronie.
       @page :first usuwa stopkę/nagłówek z pierwszej strony.
    ════════════════════════════════════════════════════════════════════════ #}

    {# ── COVER HERO (Dashboard header — premium, ciemne tło) ─────────────── #}
    <div class="cover-hero-dashboard">

        {# Logo #}
        <div class="cover-logo">☀ Soolevo<span>.com</span></div>

        {# Tytuł + podtytuł #}
        <div class="cover-title">Raport<br>Fotowoltaiczny</div>
        <div class="cover-subtitle">
            Pełna analiza opłacalności instalacji PV
            {% if standard and standard.total_power_kwp %}
                &nbsp;·&nbsp; System {{ "%.1f"|format(standard.total_power_kwp) }} kWp
            {% endif %}
            {% if req and req.province %}
                &nbsp;·&nbsp; Woj.&nbsp;<strong style="color:white;">{{ req.province | capitalize }}</strong>
            {% endif %}
            &nbsp;·&nbsp; {{ generation_date }}
        </div>

        {# Pasek 4 kluczowych KPI #}
        <div class="cover-stats-bar">
            <div class="cover-stat">
                <div class="cover-stat-label">Moc systemu</div>
                <div class="cover-stat-value">
                    {% if standard and standard.total_power_kwp %}
                        {{ "%.1f"|format(standard.total_power_kwp) }} kWp
                    {% else %}—{% endif %}
                </div>
            </div>
            <div class="cover-stat">
                <div class="cover-stat-label">Koszt instalacji</div>
                <div class="cover-stat-value">
                    {% if standard and standard.pv_cost_gross_pln %}
                        {{ standard.pv_cost_gross_pln | format_pln }}
                    {% else %}—{% endif %}
                </div>
            </div>
            <div class="cover-stat">
                <div class="cover-stat-label">Zwrot inwestycji</div>
                <div class="cover-stat-value">
                    {% if standard and standard.pv_payback_years %}
                        ok. {{ standard.pv_payback_years | round(1) }} lat
                    {% else %}—{% endif %}
                </div>
            </div>
            <div class="cover-stat">
                <div class="cover-stat-label">Oszczędności 25 lat</div>
                <div class="cover-stat-value">
                    {% if standard and standard.pv_total_savings_25y_pln %}
                        ok. {{ standard.pv_total_savings_25y_pln | format_pln }}
                    {% else %}—{% endif %}
                </div>
            </div>
        </div>

    </div>{# /cover-hero-dashboard #}

    {# ── S0 + S1 bez page-break — kontynuacja na stronie 1 ──────────────── #}
    <div class="page-section" style="margin-top: 14px;">
        {% include "report/s0_inputs.html" %}
        {% include "report/s1_verdict.html" %}
    </div>

    {# ════════════════════════════════════════════════════════════════════════
       STRONA 2: S4 — Porównanie wariantów (awans z dawnej strony 4)
    ════════════════════════════════════════════════════════════════════════ #}
    <div class="page-break"></div>

    <div class="page-section">
        {% include "report/s4_alternatives.html" %}
    </div>

    {# ════════════════════════════════════════════════════════════════════════
       STRONA 3: S3 — Wykresy (monthly_balance + cashflow_25)
    ════════════════════════════════════════════════════════════════════════ #}
    <div class="page-break"></div>

    <div class="page-section">
        {% include "report/s3_charts.html" %}
    </div>

    {# ════════════════════════════════════════════════════════════════════════
       STRONA 4: S3 cd. — Wykresy (daily_flow + roof_panels)
    ════════════════════════════════════════════════════════════════════════ #}
    <div class="page-break"></div>

    <div class="page-section">
        {% include "report/s3_charts_p2.html" %}
    </div>

    {# S5 — Ostrzeżenia (warunkowo, po wykresach) #}
    {% if warnings and warnings | length > 0 %}
    <div class="page-break"></div>
    <div class="page-section">
        {% include "report/s5_warnings.html" %}
    </div>
    {% endif %}

    <div class="page-break"></div>

    {# S6 — Dotacje i dofinansowania #}
    <div class="page-section">
        {% include "report/s6_subsidies.html" %}
    </div>

    <div class="page-break"></div>

    {# S7 — Przewodnik po procesie zakupu #}
    <div class="page-section">
        {% include "report/s7_guide.html" %}
    </div>

    <div class="page-break"></div>

    {# S8 — Następne kroki #}
    <div class="page-section">
        {% include "report/s8_next_steps.html" %}
    </div>

    {# S9 — Zastrzeżenia prawne + stopka wewnętrzna #}
    <div class="page-section" style="margin-top: 20px;">
        {% include "report/s9_disclaimer.html" %}
    </div>

    {# Stopka wewnątrz treści — ostatnia strona #}
    <div class="report-footer-block avoid-break">
        <div class="report-footer-brand">☀ Soolevo</div>
        <div class="report-footer-meta">
            Wygenerowano {{ generation_date }}<br>
            Raport fotowoltaiczny v{{ version }}
        </div>
    </div>

</body>
</html>
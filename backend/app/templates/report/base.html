<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Raport Fotowoltaiczny — Soolevo</title>
    <style>{{ css_content | safe }}</style>
</head>

<body>

    {# ── Element niewidoczny — przekazuje datę do CSS string() dla stopki @page ── #}
    <span class="pdf-generation-date" aria-hidden="true">{{ generation_date }}</span>

    {# ════════════════════════════════════════════════════════════════════════
       STRONA 1: DASHBOARD (Okładka + S0 + S1)
       Brak wymuszonego łamania strony po sekcji Hero.
       Całość tworzy spójny panel analityczny.
    ════════════════════════════════════════════════════════════════════════ #}
    
    {# Kontener Dashboardu #}
    <div class="dashboard-page" style="page-break-after: always;">

        {# 1. HERO / COVER SECTION #}
        <div class="cover-hero avoid-break" style="
            background: linear-gradient(135deg, var(--c-primary) 0%, var(--c-accent) 100%);
            border-radius: 14px;
            overflow: hidden;
            margin-bottom: 20px;
            color: white;
        ">
            {# Logo i Tytuł #}
            <div style="padding: 24px 28px 18px;">
                <div style="font-size:14pt; font-weight:900; margin-bottom:12px; letter-spacing:-0.02em;">
                    ☀ Soolevo<span style="opacity:0.7;">.com</span>
                </div>
                <h1 style="font-size:24pt; font-weight:900; margin:0 0 6px; line-height:1.1;">
                    Raport Fotowoltaiczny
                </h1>
                <p style="color:#BFD9ED; font-size:10pt; margin:0; line-height:1.5;">
                    Kompletna analiza opłacalności
                    {% if standard and standard.total_power_kwp %}
                        &nbsp;·&nbsp; System {{ "%.2f"|format(standard.total_power_kwp) }} kWp
                    {% endif %}
                    &nbsp;·&nbsp; {{ generation_date }}
                </p>
            </div>

            {# Pasek 4 kluczowych statystyk (Dashboard KPI) #}
            <div style="
                display: grid;
                grid-template-columns: repeat(4, 1fr);
                background: rgba(0,0,0,0.15);
                border-top: 1px solid rgba(255,255,255,0.1);
            ">
                {# Moc systemu #}
                <div style="padding:14px 18px; border-right:1px solid rgba(255,255,255,0.1);">
                    <div style="font-size:8pt; text-transform:uppercase; opacity:0.7; margin-bottom:4px;">Moc systemu</div>
                    <div style="font-size:13pt; font-weight:700;">
                        {% if standard and standard.total_power_kwp %}
                            {{ "%.2f"|format(standard.total_power_kwp) }} kWp
                        {% else %}—{% endif %}
                    </div>
                </div>

                {# Koszt instalacji #}
                <div style="padding:14px 18px; border-right:1px solid rgba(255,255,255,0.1);">
                    <div style="font-size:8pt; text-transform:uppercase; opacity:0.7; margin-bottom:4px;">Koszt instalacji</div>
                    <div style="font-size:13pt; font-weight:700;">
                        {% if standard and standard.pv_cost_gross_pln %}
                            {{ standard.pv_cost_gross_pln | format_pln }}
                        {% else %}—{% endif %}
                    </div>
                </div>

                {# Zwrot #}
                <div style="padding:14px 18px; border-right:1px solid rgba(255,255,255,0.1);">
                    <div style="font-size:8pt; text-transform:uppercase; opacity:0.7; margin-bottom:4px;">Zwrot inwestycji</div>
                    <div style="font-size:13pt; font-weight:700;">
                        {% if standard and standard.pv_payback_years %}
                            ok. {{ standard.pv_payback_years | round(1) }} lat
                        {% else %}—{% endif %}
                    </div>
                </div>

                {# Zysk 25 lat #}
                <div style="padding:14px 18px;">
                    <div style="font-size:8pt; text-transform:uppercase; opacity:0.7; margin-bottom:4px;">Zysk 25 lat</div>
                    <div style="font-size:13pt; font-weight:700;">
                        {% if standard and standard.pv_total_savings_25y_pln %}
                            ok. {{ standard.pv_total_savings_25y_pln | format_pln }}
                        {% else %}—{% endif %}
                    </div>
                </div>
            </div>
        </div>

        {# 2. S0 - DANE WEJŚCIOWE #}
        <div class="page-section avoid-break" style="margin-bottom: 20px;">
            {% include "report/s0_inputs.html" %}
        </div>

        {# 3. S1 - WERDYKT #}
        <div class="page-section avoid-break">
            {% include "report/s1_verdict.html" %}
        </div>

    </div>{# /dashboard-page #}

    {# ════════════════════════════════════════════════════════════════════════
       STRONA 2+: SZCZEGÓŁY ANALIZY
    ════════════════════════════════════════════════════════════════════════ #}

    {# S4 — Porównanie wariantów (Główna sekcja analityczna) #}
    <div class="page-section">
        {% include "report/s4_alternatives.html" %}
    </div>

    <div class="page-break"></div>

    {# S3 — Wykresy (Rozbite na 2 strony wewnątrz pliku) #}
    <div class="page-section">
        {% include "report/s3_charts.html" %}
    </div>

    <div class="page-break"></div>

    {# S5 — Ostrzeżenia (warunkowo) #}
    {% if warnings and warnings | length > 0 %}
    <div class="page-section">
        {% include "report/s5_warnings.html" %}
    </div>
    <div class="page-break"></div>
    {% endif %}

    {# S6 — Dotacje i dofinansowania #}
    <div class="page-section">
        {% include "report/s6_subsidies.html" %}
    </div>

    <div class="page-break"></div>

    {# S7 — Przewodnik po procesie zakupu #}
    <div class="page-section">
        {% include "report/s7_guide.html" %}
    </div>

    <div class="page-break"></div>

    {# S8 — Następne kroki #}
    <div class="page-section">
        {% include "report/s8_next_steps.html" %}
    </div>

    {# S9 — Zastrzeżenia prawne + stopka wewnętrzna #}
    <div class="page-section" style="margin-top: 20px;">
        {% include "report/s9_disclaimer.html" %}
    </div>

    {# Stopka wewnątrz treści — ostatnia strona #}
    <div class="report-footer-block avoid-break">
        <div class="report-footer-brand">☀ Soolevo</div>
        <div class="report-footer-meta">
            Wygenerowano {{ generation_date }}<br>
            Raport fotowoltaiczny v{{ version }}
        </div>
    </div>

</body>
</html>